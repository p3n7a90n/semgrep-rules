rules:
  - id: command_execution
    patterns:
      - pattern-either:
          - pattern: system(...)
          - pattern: exec(...)
          - pattern: passthru(...)
          - pattern: shell_exec(...)
    message: Probable Command Execution
    languages:
      - php
    severity: WARNING
    metadata:
      category: security
      technology:
        - Wordpress Plugins
      references:
        - https://github.com/wpscanteam/wpscan/wiki/WordPress-Plugin-Security-Testing-Cheat-Sheet#command-execution
      owasp: A3:2021 injection
      cwe: "CWE 78: Improper Neutralization of Special Elements used in an OS Command
        ('OS Command Injection')"
